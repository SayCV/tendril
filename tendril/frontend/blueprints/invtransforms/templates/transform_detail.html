{#
    Copyright (c) 2015 Chintalagiri Shashank
    Released under the MIT license
#}

{% extends "base_templates/base.html" %}

{% block main %}

<p></p>

<h4> Inventory Transform {{ stage.loc.name }} ({{ stage.loc._name }})</h4>

<div class="small-12 columns">
    {% if stage.loc._reader._xlf %}
    <ul style="list-style-type: none;">
        <li class="small-12 medium-6 large-8 columns panel radius text-center">
            <b>Transform Path</b> <br>
            {{ stage.tf._tfpath }}
        </li>
        <li class="small-12 medium-6 large-8 columns panel radius text-center">
            <b>File Path</b> <br>
            {{ stage.loc._reader.filepath }}
        </li>
        <li class="small-12 medium-3 large-2 columns panel radius text-center">
            Sheet Name <br>
            <b>{{ stage.loc._reader.sheetname }}</b>
        </li>
        <li class="small-12 medium-3 large-2 columns panel radius text-center">
            Quantity Date <br>
            <b>{{ stage.loc._reader.qtydate }} </b>
        </li>
    </ul>
    {% endif %}
</div>

<div class="small-12 columns" data-magellan-destination="transformtable">
<a name="transformtable"></a>
        <div class="small-12 columns">
            <table id="transform_table" class="display" data-paging='false' width="100%">
                <thead>
                <tr>
                    <th class="all">Contextual Representation</th>
                    <th class="all">Canonical Representation</th>
                    <th class="all text-center">Status</th>
                    <th class="all text-center">In gsymlib</th>
                </tr>
                </thead>
                <tbody>
                {% for key in stage.tf.names %}
                    <tr>
                        <td> {{ key }} </td>
                        <td> {{ stage.tf.get_canonical_repr(key) }} </td>
                        {% set status = stage.tf.get_status(key) %}
                        <td class="text-center
                            {% if status=='NEW' %} resultcell-fail
                            {% elif status=='OK' %} resultcell-pass
                            {% else %} resultcell-yellow {% endif %}
                        "> {{ status }} </td>
                        <td
                            {% if stage.tf.get_canonical_repr(key) in stage.gsymlib_idents %}
                                class="resultcell-pass"> Yes
                            {% else %}
                                class="resultcell-fail"> No
                            {% endif %}
                        </td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        </div>
        <script type="text/javascript">
            $(document).ready( function () {
                var table = $('#transform_table').DataTable({
                    /* Disable initial sort */
                    "order": [[ 1, "asc" ]],
                    "columnDefs":[
                        {"width": "8em", "targets": [2,3]},
                    ],
                    {% include 'parts/datatable_defaults.html' %}
                });
                table.buttons().container()
                    .appendTo( '#transform_table_wrapper .small-12.medium-6.columns:eq(0)' );
            });
        </script>
</div>


{% endblock %}
